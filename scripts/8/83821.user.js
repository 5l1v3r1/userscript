// ==UserScript==// @name          GMail 'Mark all as read' button// @description   Adds a one-click "Mark all as read" function to GMail// @namespace     http://coding.pressbin.com/38/Cool-hack-Mark-all-as-read-button-for-GMail/// @include       https://mail.google.com/mail/?ui=2*// ==/UserScript==var myInterval = setInterval(function() {   if (document.body.innerHTML.match('<div class="nH">') ) {      var allDivs = document.getElementsByTagName('div');      if (allDivs.length > 700) {         clearInterval(myInterval);         addNewButton();      }   }}, 400);function addNewButton() {   var div1 = document.createElement('div');   div1.innerHTML = 'Mark all as read';   div1.className = 'J-K-I-Jz';      var div1a = document.createElement('div');   div1a.innerHTML = '&nbsp;';   div1a.className = 'J-K-I-K9-KP';   var div2 = document.createElement('div');   div2.className = 'J-K-I-KC';   var div3 = document.createElement('div');   div3.className = 'J-J5-Ji J-K-I-J6-H';   var div4 = document.createElement('div');   div4.className = 'J-J5-Ji J-K-I-Kv-H';   var div5 = document.createElement('div');   div5.className = 'J-K-I J-J5-Ji L3';   var div6 = document.createElement('div');   div6.className = 'Pl J-J5-Ji';      div6.appendChild(div5);   div5.appendChild(div4);   div4.appendChild(div3);   div3.appendChild(div2);   div2.appendChild(div1a);   div2.appendChild(div1);      div6.addEventListener('click', markAllAsRead, true);   div6.addEventListener('mouseover', function() { div5.className = 'J-K-I J-J5-Ji L3 J-K-I-JW'; }, true);   div6.addEventListener('mouseout', function() { div5.className = 'J-K-I J-J5-Ji L3'; }, true);   div6.addEventListener('mousedown', function() { div5.className = 'J-K-I J-J5-Ji L3 J-K-I-JW J-K-I-Je J-K-I-JO'; }, true);   div6.addEventListener('mouseup', function() { div5.className = 'J-K-I J-J5-Ji L3'; }, true);   applyToClass('Pl J-J5-Ji', 2, function(el) { el.parentNode.insertBefore(div6, el); }, '');   }function markAllAsRead() {   applyToClass('J-K-I-Jz', 0, function(el) {       mEvent('mousedown', el);      applyToClass('J-N-Jz', 0, function(el2) {          mEvent('mouseup', el2);           }, 'Mark all as read');   }, 'More actions');}function applyToClass(thisClass, thisOrder, thisFunction, textMatch) {   var breakMe = 0;   var allDivs = new Array();   var allDivs = document.getElementsByTagName('div');   for (i=0; i < allDivs.length; i++) {      if (allDivs[i].className==thisClass) {         if (textMatch == '' || allDivs[i].innerHTML.match(textMatch)) {            if (breakMe == thisOrder) {               thisFunction(allDivs[i]);                }                 breakMe++;         }      }   }      }function mEvent(e, el) {   var evt = document.createEvent('MouseEvents');   evt.initMouseEvent(e, true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);   el.dispatchEvent(evt);}